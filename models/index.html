<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Built-in models · FuzzifiED.jl</title><meta name="title" content="Built-in models · FuzzifiED.jl"/><meta property="og:title" content="Built-in models · FuzzifiED.jl"/><meta property="twitter:title" content="Built-in models · FuzzifiED.jl"/><meta name="description" content="Documentation for FuzzifiED.jl."/><meta property="og:description" content="Documentation for FuzzifiED.jl."/><meta property="twitter:description" content="Documentation for FuzzifiED.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/themes/serif.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="FuzzifiED.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">FuzzifiED.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../example/">Example</a></li><li><a class="tocitem" href="../core/">Core functions</a></li><li><a class="tocitem" href="../itensors/">ITensors support</a></li><li class="is-active"><a class="tocitem" href>Built-in models</a><ul class="internal"><li><a class="tocitem" href="#Diagonal-quantum-numbers-on-fuzzy-sphere"><span>Diagonal quantum numbers on fuzzy sphere</span></a></li><li><a class="tocitem" href="#Off-diagonal-quantum-numbers-on-fuzzy-sphere"><span>Off-diagonal quantum numbers on fuzzy sphere</span></a></li><li><a class="tocitem" href="#Operators-on-fuzzy-sphere"><span>Operators on fuzzy sphere</span></a></li><li><a class="tocitem" href="#Spherical-observables"><span>Spherical observables</span></a></li><li><a class="tocitem" href="#Angular-modes"><span>Angular modes</span></a></li></ul></li><li><a class="tocitem" href="../archieve/">Archieved interfaces</a></li><li><a class="tocitem" href="../releases/">Releases</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Built-in models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Built-in models</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/mankai-chow/fuzzifi_ed" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/mankai-chow/fuzzifi_ed/blob/main/docs/src/models.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Built-in-models"><a class="docs-heading-anchor" href="#Built-in-models">Built-in models</a><a id="Built-in-models-1"></a><a class="docs-heading-anchor-permalink" href="#Built-in-models" title="Permalink"></a></h1><h2 id="Diagonal-quantum-numbers-on-fuzzy-sphere"><a class="docs-heading-anchor" href="#Diagonal-quantum-numbers-on-fuzzy-sphere">Diagonal quantum numbers on fuzzy sphere</a><a id="Diagonal-quantum-numbers-on-fuzzy-sphere-1"></a><a class="docs-heading-anchor-permalink" href="#Diagonal-quantum-numbers-on-fuzzy-sphere" title="Permalink"></a></h2><p>The following diagonal quantum numbers (symmetry charges) on fuzzy sphere are built in in FuzzifiED.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.GetNeQNDiag-Tuple{Int64}" href="#Main.FuzzifiED.GetNeQNDiag-Tuple{Int64}"><code>Main.FuzzifiED.GetNeQNDiag</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function GetNeQNDiag(no :: Int64) :: QNDiag</code></pre><p>Return the QNDiag of the number of electrons, implemented as </p><pre><code class="language-julia hljs">    QNDiag(&quot;Ne&quot;, fill(1, no))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/qndiag.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.GetLz2QNDiag-Tuple{Int64, Int64}" href="#Main.FuzzifiED.GetLz2QNDiag-Tuple{Int64, Int64}"><code>Main.FuzzifiED.GetLz2QNDiag</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function GetLz2QNDiag(nm :: Int64, nf :: Int64) :: QNDiag</code></pre><p>Return the QNDiag of the number of twice the angular momentum <span>$2L_z$</span>, implemented as </p><pre><code class="language-julia hljs">    QNDiag(&quot;Lz&quot;, collect(0 : nm * nf - 1) .÷ nf .* 2 .- (nm - 1))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/qndiag.jl#L12-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.GetFlavQNDiag" href="#Main.FuzzifiED.GetFlavQNDiag"><code>Main.FuzzifiED.GetFlavQNDiag</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function GetFlavQNDiag(nm :: Int64, nf :: Int64, qf :: Dict{Int64, Int64}[, id :: Int64 = 1, modul :: Int64 = 1]) :: QNDiag 
function GetFlavQNDiag(nm :: Int64, nf :: Int64, qf :: Vector{Int64}[, id :: Int64 = 1, modul :: Int64 = 1]) :: QNDiag</code></pre><p>Return the QNDiag of linear combination of number of electrons in each flavour, </p><p class="math-container">\[    Q = ∑_{f}q_fn_f\]</p><p>the factor <span>$q_f$</span> can either be given by a length-<span>$N_f$</span> vector or a dictionary containing non-zero terms. <em>E.g.</em>, for <span>$Q=n_{f=1}-n_{f=3}$</span> in a 4-flavour system, <code>qf = [1, 0, -1, 0]</code> or <code>qf = Dict(1 =&gt; 1, 3 =&gt; -3)</code>. <code>id</code> is an index to be put in the name to distinguish. For <code>qf</code> given as vector, the function is implemented as </p><pre><code class="language-julia hljs">QNDiag(&quot;Sz$id&quot;, qf[collect(0 : nm * nf - 1) .% nf .+ 1], modul)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/qndiag.jl#L32-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.GetZnfChargeQNDiag-Tuple{Int64, Int64}" href="#Main.FuzzifiED.GetZnfChargeQNDiag-Tuple{Int64, Int64}"><code>Main.FuzzifiED.GetZnfChargeQNDiag</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function GetZnfChargeQNDiag(nm :: Int64, nf :: Int64) :: QNDiag</code></pre><p>Return the QNDiag of a <span>$ℤ_{N_f}$</span>-charge, </p><p class="math-container">\[    Q = ∑_{f=0}^{N_f-1}fn_f\ \mathrm{mod}\ N_f\]</p><p>implemented as </p><pre><code class="language-julia hljs">    QNDiag(&quot;Q_Z$nf&quot;, collect(0 : nm * nf - 1) .% nf, nf)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/qndiag.jl#L48-L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.GetPinOrbQNDiag" href="#Main.FuzzifiED.GetPinOrbQNDiag"><code>Main.FuzzifiED.GetPinOrbQNDiag</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function GetPinOrbQNDiag(no :: Int64, pin_o :: Vector{Int64}[, id :: Int64 = 1]) :: QNDiag</code></pre><p>Return the QNDiag of the number of electrons in the subset <code>pin_o</code>, implemented as</p><pre><code class="language-julia hljs">    QNDiag(&quot;Npin$i&quot;, [ o in pin_o ? 1 : 0 for o = 1 : no])</code></pre><p>This QNDiag is useful in pinning defects, where certain subset of orbitals need to be set empty or filled. To empty the orbitals, set this QNDiag to 0 ; to fill the orbitals, set this QNDiag to <code>length(pin_o)</code>. <code>id</code> is an index to be put in the name to distinguish. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/qndiag.jl#L63-L72">source</a></section></article><h2 id="Off-diagonal-quantum-numbers-on-fuzzy-sphere"><a class="docs-heading-anchor" href="#Off-diagonal-quantum-numbers-on-fuzzy-sphere">Off-diagonal quantum numbers on fuzzy sphere</a><a id="Off-diagonal-quantum-numbers-on-fuzzy-sphere-1"></a><a class="docs-heading-anchor-permalink" href="#Off-diagonal-quantum-numbers-on-fuzzy-sphere" title="Permalink"></a></h2><p>The following off-diagonal quantum numbers (transformations) on fuzzy sphere are built in in FuzzifiED.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.GetParityQNOffd" href="#Main.FuzzifiED.GetParityQNOffd"><code>Main.FuzzifiED.GetParityQNOffd</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function GetParityQNOffd(nm :: Int64, nf :: Int64[, permf, fac])</code></pre><p>Return the particle-hole transformation </p><p class="math-container">\[    𝒫: c^†_{mf}↦α_fc_{mπ_f}\]</p><p><strong>Arguments</strong></p><ul><li><code>nm :: Int64</code> and <code>nf :: Int64</code> are the number of orbitals and the flavours.</li><li><code>permf :: Dict{Int64, Int64}</code>, <code>permf :: Vector{Vector{Int64}}</code> or <code>Vector{Int64}</code> gives the flavour permutation <span>$π_f$</span>. It is either a vector of the cycles, a vector of the target flavours, or a dictionary of the changed elements. <em>E.g.</em>, a permutation <span>$1↦4,2↦5,3↦3,4↦1,5↦6,6↦2$</span> can be expressed as <code>[4,5,3,1,6,2]</code>, <code>[[1,4],[2,5,6]]</code> or <code>Dict(1=&gt;4,2=&gt;5,4=&gt;1,5=&gt;6,6=&gt;2)</code>. Facultative, identity by default. </li><li><code>fac :: Dict{Int64, &lt;: Number}</code> or <code>Vector{&lt;: Number}</code> gives the factor <span>$α_f$</span>. It is either a vector of all vectors, or a dictionary of all non-unity elements. Facultative, all unity by default. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/qnoffd.jl#L29-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.GetFlavPermQNOffd" href="#Main.FuzzifiED.GetFlavPermQNOffd"><code>Main.FuzzifiED.GetFlavPermQNOffd</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function GetFlavPermQNOffd(nm :: Int64, nf :: Int64, permf , fac][, cyc])</code></pre><p>Return the flavour permutaiton transformation </p><p class="math-container">\[    𝒵: c^†_{mf}↦α_fc^†_{mπ_f}\]</p><p><strong>Arguments</strong></p><ul><li><code>nm :: Int64</code> and <code>nf :: Int64</code> are the number of orbitals and the flavours.</li><li><code>permf :: Dict{Int64, Int64}</code>, <code>permf :: Vector{Vector{Int64}}</code> or <code>Vector{Int64}</code> gives the flavour permutation <span>$π_f$</span>. It is either a vector of the cycles, a vector of the target flavours, or a dictionary of the changed elements. <em>E.g.</em>, a permutation <span>$1↦4,2↦5,3↦3,4↦1,5↦6,6↦2$</span> can be expressed as <code>[4,5,3,1,6,2]</code>, <code>[[1,4],[2,5,6]]</code> or <code>Dict(1=&gt;4,2=&gt;5,4=&gt;1,5=&gt;6,6=&gt;2)</code>. Facultative, identity by default. </li><li><code>fac :: Dict{Int64, &lt;: Number}</code> or <code>Vector{&lt;: Number}</code> gives the factor <span>$α_f$</span>. It is either a vector of all vectors, or a dictionary of all non-unity elements. Facultative, all unity by default. </li><li><code>cyc :: Int64</code> is the period of the permutation. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/qnoffd.jl#L53-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.GetRotyQNOffd-Tuple{Int64, Int64}" href="#Main.FuzzifiED.GetRotyQNOffd-Tuple{Int64, Int64}"><code>Main.FuzzifiED.GetRotyQNOffd</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function GetRotyQNOffd(nm :: Int64, nf :: Int64)</code></pre><p>Return the <span>$π$</span>-rotation along the <span>$y$</span>-axis. </p><p class="math-container">\[    ℛ_y: c^†_{mf}↦(-)^{m+s}c^†_{-mf}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/qnoffd.jl#L79-L86">source</a></section></article><h2 id="Operators-on-fuzzy-sphere"><a class="docs-heading-anchor" href="#Operators-on-fuzzy-sphere">Operators on fuzzy sphere</a><a id="Operators-on-fuzzy-sphere-1"></a><a class="docs-heading-anchor-permalink" href="#Operators-on-fuzzy-sphere" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.GetIntMatrix-Tuple{Int64, Vector{Number}}" href="#Main.FuzzifiED.GetIntMatrix-Tuple{Int64, Vector{Number}}"><code>Main.FuzzifiED.GetIntMatrix</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function GetIntMatrix(nm :: Int64, ps_pot :: Vector{Number}) :: Array{ComplexF64, 3}</code></pre><p><strong>Argument</strong></p><ul><li><code>nm :: Int64</code> is the number of orbitals</li><li><code>ps_pot :: Vector{Number}</code> is the vector of non-zero pseudopotentials </li></ul><p><strong>Output</strong></p><ul><li>A <code>nm</code>*<code>nm</code>*<code>nm</code> array giving the interaction matrix <span>$U_{m_1,m_2,m_3,-m_1-m_2-m_3}$</span></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/opterms.jl#L1-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.GetDenIntTerms" href="#Main.FuzzifiED.GetDenIntTerms"><code>Main.FuzzifiED.GetDenIntTerms</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">GetDenIntTerms(nm :: Int64, nf :: Int64[, ps_pot :: Vector{&lt;:Number}][, mat_a :: Matrix{&lt;:Number}[, mat_b :: Matrix{&lt;:Number}]][ ; m_kept :: Vector{Int64}]) :: Vector{Term}</code></pre><p>Return the normal-ordered density-density term in the Hamiltonian </p><p class="math-container">\[∑_{\{m_i,f_i\}}U_{m_1m_2m_3m_4}M^A_{f_1f_4}M^B_{f_2f_3}c^{†}_{m_1f_1}c^{†}_{m_2f_2}c_{m_3f_3}c_{m_4f_4}\]</p><p><strong>Arguments</strong></p><ul><li><code>nm :: Int64</code> is the number of orbitals.</li><li><code>nf :: Int64</code> is the number of flavours.</li><li><code>ps_pot :: Vector{&lt;:Number}</code> is a list of numbers specifying the pseudopotentials for the interacting matrix <span>$U_{m_1m_2m_3m_4}$</span>. Facultative, <code>[1.0]</code> by default. </li><li><code>mat_a :: Matrix{&lt;:Number}</code> is a <code>nf</code>*<code>nf</code> matrix specifying <span>$M^A_{ff&#39;}$</span>. Facultative, <span>$I_{N_f}$</span> by default. </li><li><code>mat_b :: Matrix{&lt;:Number}</code> is a <code>nf</code>*<code>nf</code> matrix specifying <span>$M^B_{ff&#39;}$</span>. Facultative, the Hermitian conjugate of <code>mat_a</code> by default. </li><li><code>m_kept :: Vector{Int64}</code> is a list of orbitals that range from 1 to <code>nm</code>. Facultative, if specified, only terms for which all <span>$m_i$</span> are in the list are kept. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/opterms.jl#L40-L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.GetDenIntTerms" href="#Main.FuzzifiED.GetDenIntTerms"><code>Main.FuzzifiED.GetDenIntTerms</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">GetDenIntTerms(nm :: Int64, nf :: Int64, ps_pot :: Vector{&lt;:Number}, mat_a :: Vector{&lt;:AbstractMatrix{&lt;:Number}}[, mat_b :: Vector{&lt;:AbstractMatrix{&lt;:Number}}][ ; m_kept :: Vector{Int64}]) :: Vector{Term}</code></pre><p>Return the sum of a series of normal-ordered density-density term in the Hamiltonian </p><p class="math-container">\[∑_{\{m_i,f_i,α\}}U_{m_1m_2m_3m_4}(M^A_{α})_{f_1f_4}(M^B_{α})_{f_2f_3}c^{†}_{m_1f_1}c^{†}_{m_2f_2}c_{m_3f_3}c_{m_4f_4}\]</p><p><strong>Arguments</strong></p><ul><li><code>nm :: Int64</code> is the number of orbitals.</li><li><code>nf :: Int64</code> is the number of flavours.</li><li><code>ps_pot :: Vector{&lt;:Number}</code> is a list of numbers specifying the pseudopotentials for the interacting matrix <span>$U_{m_1m_2m_3m_4}$</span>. Facultative, <code>[1.0]</code> by default.</li><li><code>mat_a :: Vector{&lt;:AbstractMatrix{&lt;:Number}}</code> is a vector of <code>nf</code>*<code>nf</code> matrix specifying <span>$(M^A_{α})_{ff&#39;}$</span>. Facultative, <span>$I_{N_f}$</span> by default. </li><li><code>mat_b :: Vector{&lt;:AbstractMatrix{&lt;:Number}}</code> is a vector of <code>nf</code>*<code>nf</code> matrix specifying <span>$(M^B_{α})_{ff&#39;}$</span>. Facultative, the Hermitian conjugate of <code>mat_a</code> by default. </li><li><code>m_kept :: Vector{Int64}</code> is a list of orbitals that range from 1 to <code>nm</code>. Facultative, if specified, only terms for which all <span>$m_i$</span> are in the list are kept. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/opterms.jl#L99-L116">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.GetPairIntTerms" href="#Main.FuzzifiED.GetPairIntTerms"><code>Main.FuzzifiED.GetPairIntTerms</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">GetPairIntTerms(nm :: Int64, nf :: Int64, ps_pot :: Vector{&lt;:Number}, mat_a :: Matrix{&lt;:Number}[, mat_b :: Matrix{&lt;:Number}][ ; m_kept :: Vector{Int64}]) :: Vector{Term}</code></pre><p>Return the normal-ordered pair-pair interaction term in the Hamiltonian </p><p class="math-container">\[∑_{\{m_i,f_i\}}U_{m_1m_2m_3m_4}M^A_{f_1f_2}M^B_{f_3f_4}c^{†}_{m_1f_1}c^{†}_{m_2f_2}c_{m_3f_3}c_{m_4f_4}\]</p><p><strong>Arguments</strong></p><ul><li><code>nm :: Int64</code> is the number of orbitals.</li><li><code>nf :: Int64</code> is the number of flavours.</li><li><code>ps_pot :: Vector{&lt;:Number}</code> is a list of numbers specifying the pseudopotentials for the interacting matrix <span>$U_{m_1m_2m_3m_4}$</span>. </li><li><code>mat_a :: Matrix{&lt;:Number}</code> is a <code>nf</code>*<code>nf</code> matrix specifying <span>$M^A_{ff&#39;}$</span>. Facultative, <span>$I_{N_f}$</span> by default. </li><li><code>mat_b :: Matrix{&lt;:Number}</code> is a <code>nf</code>*<code>nf</code> matrix specifying <span>$M^B_{ff&#39;}$</span>. Facultative, the Hermitian conjugate of <code>mat_a</code> by default. </li><li><code>m_kept :: Vector{Int64}</code> is a list of orbitals that range from 1 to <code>nm</code>. Facultative, if specified, only terms for which all <span>$m_i$</span> are in the list are kept. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/opterms.jl#L123-L140">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.GetPolTerms-Tuple{Int64, Int64, Matrix{&lt;:Number}}" href="#Main.FuzzifiED.GetPolTerms-Tuple{Int64, Int64, Matrix{&lt;:Number}}"><code>Main.FuzzifiED.GetPolTerms</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">GetPolTerms(nm :: Int64, nf :: Int64[, mat :: Matrix{&lt;:Number}][ ; fld_m :: Vector{&lt;:Number}]) :: Vector{Term}</code></pre><p>Return the polarisation term in the Hamiltonian </p><p class="math-container">\[∑_{mff&#39;}c^{†}_{mf}M_{ff&#39;}c_{mf&#39;}\]</p><p><strong>Arguments</strong></p><ul><li><code>nm :: Int64</code> is the number of orbitals ;</li><li><code>nf :: Int64</code> is the number of flavours ; </li><li><code>mat :: Matrix{&lt;:Number}</code> is a <code>nf</code>*<code>nf</code> matrix specifying <span>$M_{ff&#39;}$</span>. Facultative, <span>$I_{N_f}$</span> by default. </li><li><code>fld_m :: Vector{&lt;:Number}</code> gives an orbital dependent polarisation</li></ul><p class="math-container">\[∑_{mff&#39;}h_mc^{†}_{mf}M_{ff&#39;}c_{mf&#39;}\]</p><p>Facultative. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/opterms.jl#L181-L200">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.GetL2Terms-Tuple{Int64, Int64}" href="#Main.FuzzifiED.GetL2Terms-Tuple{Int64, Int64}"><code>Main.FuzzifiED.GetL2Terms</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function GetL2Terms(nm :: Int64, nf :: Int64) :: Vector{Term}</code></pre><p>Return the terms for the total angular momentum.</p><p><strong>Arguments</strong></p><ul><li><code>nm :: Int64</code> is the number of orbitals.</li><li><code>nf :: Int64</code> is the number of flavours.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/opterms.jl#L218-L226">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.GetC2Terms-Tuple{Int64, Int64, Vector{&lt;:AbstractMatrix{&lt;:Number}}}" href="#Main.FuzzifiED.GetC2Terms-Tuple{Int64, Int64, Vector{&lt;:AbstractMatrix{&lt;:Number}}}"><code>Main.FuzzifiED.GetC2Terms</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function GetC2Terms(nm :: Int64, nf :: Int64, mat_gen :: Vector{&lt;:AbstractMatrix{&lt;:Number}}) :: Vector{Term}</code></pre><p>Return the terms for the quadratic Casimir of the flavour symmetry</p><p><strong>Arguments</strong></p><ul><li><code>nm :: Int64</code> is the number of orbitals.</li><li><code>nf :: Int64</code> is the number of flavours.</li><li><code>mat_gen :: Vector{Matrix{Number}})</code> is a list of the matrices that gives the generators. It will automatically be normalised such that its square traces to unity. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/opterms.jl#L244-L253">source</a></section></article><h2 id="Spherical-observables"><a class="docs-heading-anchor" href="#Spherical-observables">Spherical observables</a><a id="Spherical-observables-1"></a><a class="docs-heading-anchor-permalink" href="#Spherical-observables" title="Permalink"></a></h2><p>FuzzifiED supports local observables on sphere that can be decomposed into angular components <span>$\Phi(\Omega)=\sum_{lm}\Phi_{lm}Y^{(s)}_{lm}$</span></p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.SphereObs" href="#Main.FuzzifiED.SphereObs"><code>Main.FuzzifiED.SphereObs</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct SphereObs</code></pre><p>stores the information of a local observable (or local operator) <span>$\Phi$</span> that can be decomposed into angular components.</p><p class="math-container">\[    \Phi(\Omega)=∑_{lm}\Phi_{lm}Y^{(s)}_{lm}\]</p><p><strong>Fields</strong></p><ul><li><code>s2 :: Int64</code> is twice the spin <span>$2s$</span> of the observable.</li><li><code>l2m :: Int64</code> is twice the maximal angular momentum <span>$2l_{\max}$</span> of the components of the observable. </li><li><code>get_comp :: Function</code> is a function <code>get_comp(l2 :: Int64, m2 :: Int64) :: Vector{Term}</code> that sends the component specified by a tuple of integers <span>$(2l,2m)$</span> where <span>$|s|\leq l\leq l_{\max}, -l\leq m\leq l$</span> to a list of terms that specifies the expression of the component. </li><li><code>stored_q :: Bool</code> is a boolean that specifies whether or not each component of the observable is stored.</li><li><code>comps :: Dict{Tuple{Int64, Int64}, Vector{Term}}</code> stores each component of the observable in the format of a dictionary whose keys are the tuples of integers <span>$(2l,2m)$</span> and values are the lists of terms that specifies the expression of the component. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/sphere_obs.jl#L1-L16">source</a></section></article><p>It can be initialised with the following methods </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.SphereObs-Tuple{Int64, Int64, Function}" href="#Main.FuzzifiED.SphereObs-Tuple{Int64, Int64, Function}"><code>Main.FuzzifiED.SphereObs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function SphereObs(s2 :: Int64, l2m :: Int64, get_comp :: Function) :: SphereObs</code></pre><p>initialises the observable from <span>$2s$</span>, <span>$2l_{\max}$</span> and the function <span>$(l,m)↦\Phi_{lm}$</span></p><p><strong>Arguments</strong></p><ul><li><code>s2 :: Int64</code> is twice the spin <span>$2s$</span> of the observable.</li><li><code>l2m :: Int64</code> is twice the maximal angular momentum <span>$2l_{\max}$</span> of the components of the observable. </li><li><code>get_comp :: Function</code> is a function <code>get_comp(l2 :: Int64, m2 :: Int64) :: Vector{Term}</code> that sends the component specified by a tuple of integers <span>$(2l,2m)$</span> where <span>$|s|\leq s\leq l_{\max}, -l\leq m\leq l$</span> to a list of terms that specifies the expression of the component. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/sphere_obs.jl#L26-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.SphereObs-Tuple{Int64, Int64, Dict{Tuple{Int64, Int64}, Vector{Term}}}" href="#Main.FuzzifiED.SphereObs-Tuple{Int64, Int64, Dict{Tuple{Int64, Int64}, Vector{Term}}}"><code>Main.FuzzifiED.SphereObs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function SphereObs(s2 :: Int64, l2m :: Int64, get_comp :: Function) :: SphereObs</code></pre><p>initialises the observable from <span>$2s$</span>, <span>$2l_{\max}$</span> and a list of <span>$\Phi_{lm}$</span> specified by a dictionary. </p><p><strong>Arguments</strong></p><ul><li><code>s2 :: Int64</code> is twice the spin <span>$2s$</span> of the observable.</li><li><code>l2m :: Int64</code> is twice the maximal angular momentum <span>$2l_{\max}$</span> of the components of the observable. </li><li><code>comps :: Dict{Tuple{Int64, Int64}, Vector{Term}}</code> stores each component of the observable in the format of a dictionary whose keys are the tuples of integers <span>$(2l,2m)$</span> and values are the lists of terms that specifies the expression of the component. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/sphere_obs.jl#L41-L51">source</a></section></article><p>The following methods explicitly calculates and stores each component</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.StoreComps!-Tuple{SphereObs}" href="#Main.FuzzifiED.StoreComps!-Tuple{SphereObs}"><code>Main.FuzzifiED.StoreComps!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function StoreComps!(obs :: SphereObs) :: Nothing</code></pre><p>calculates and stores each component of the observable <code>obs</code> and replace the function in <code>obs</code> by the list of calculated components. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/sphere_obs.jl#L57-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.StoreComps-Tuple{SphereObs}" href="#Main.FuzzifiED.StoreComps-Tuple{SphereObs}"><code>Main.FuzzifiED.StoreComps</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function StoreComps(obs :: SphereObs) :: SphereObs</code></pre><p>calculates and stores each component of the observable <code>obs</code> and return a new observable with the list of calculated components. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/sphere_obs.jl#L78-L82">source</a></section></article><p>The multiplication, addition, conjugate and Laplacian operation of an observable is supported </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:*-Tuple{Number, SphereObs}" href="#Base.:*-Tuple{Number, SphereObs}"><code>Base.:*</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function *(fac :: Number, obs :: SphereObs) :: SphereObs
function *(obs :: SphereObs, fac :: Number) :: SphereObs
function /(obs :: SphereObs, fac :: Number) :: SphereObs
function -(obs :: SphereObs) :: SphereObs</code></pre><p>enables the multiplication of an observable with a number.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/sphere_obs.jl#L99-L106">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:+-Tuple{SphereObs, SphereObs}" href="#Base.:+-Tuple{SphereObs, SphereObs}"><code>Base.:+</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function +(obs1 :: SphereObs, obs2 :: SphereObs) :: SphereObs
function -(obs1 :: SphereObs, obs2 :: SphereObs) :: SphereObs</code></pre><p>enables the addition of two observables.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/sphere_obs.jl#L121-L126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.adjoint-Tuple{SphereObs}" href="#Base.adjoint-Tuple{SphereObs}"><code>Base.adjoint</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function adjoint(obs :: SphereObs) :: SphereObs</code></pre><p>enables the Hermitian conjugate of a spherical observable.</p><p class="math-container">\[\begin{aligned}
    Φ^†(Ω)&amp;=∑_{lm}(Φ_{lm})^†\bar{Y}^{(s)}_{lm}(Ω)=∑_{lm}(Φ_{lm})^†(-1)^{s+m}Y^{(-s)}_{l,-m}(Ω)\\
    (Φ^†)_{lm}&amp;=(-1)^{s-m}(Φ_{l,-m})^†
\end{aligned}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/sphere_obs.jl#L141-L151">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:*-Tuple{SphereObs, SphereObs}" href="#Base.:*-Tuple{SphereObs, SphereObs}"><code>Base.:*</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function *(obs1 :: SphereObs, obs2 :: SphereObs) :: SphereObs</code></pre><p>enables the multiplication of two observable by making use of the composition of two monopole harmonics into one. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/sphere_obs.jl#L160-L164">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.Laplacian-Tuple{SphereObs}" href="#Main.FuzzifiED.Laplacian-Tuple{SphereObs}"><code>Main.FuzzifiED.Laplacian</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function Laplacian(obs :: SphereObs) :: SphereObs</code></pre><p>Takes the Laplacian of an observable</p><p class="math-container">\[    (∇^2Φ)_{lm}=-l(l+1)Φ_{lm}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/sphere_obs.jl#L185-L192">source</a></section></article><p>The observables can be evaluated either at an angular component or at a real-space point.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.GetComponent-Tuple{SphereObs, Number, Number}" href="#Main.FuzzifiED.GetComponent-Tuple{SphereObs, Number, Number}"><code>Main.FuzzifiED.GetComponent</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function GetComponent(obs :: SphereObs, l :: Number, m :: Number) :: Vector{Term}</code></pre><p>returns an angular component <span>$Φ_{lm}$</span> of an observable in the format of a list of terms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/sphere_obs.jl#L198-L202">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.GetPointValue-Tuple{SphereObs, Float64, Float64}" href="#Main.FuzzifiED.GetPointValue-Tuple{SphereObs, Float64, Float64}"><code>Main.FuzzifiED.GetPointValue</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function GetPointValue(obs :: SphereObs, θ :: Float64, ϕ :: Float64) :: Vector{Term}</code></pre><p>evaluates an observable at one point <span>$Φ(θ,ϕ)$</span> in the format of a list of terms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/sphere_obs.jl#L208-L212">source</a></section></article><p>Three types of operators, <em>viz.</em> electrons and density operators, and pairing operators are built-in.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.Electron-Tuple{Int64, Int64, Int64}" href="#Main.FuzzifiED.Electron-Tuple{Int64, Int64, Int64}"><code>Main.FuzzifiED.Electron</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function Electron(nm :: Int64, nf :: Int64, f :: Int64) :: SphereObs</code></pre><p>returns the electron annihilation operator <span>$ψ_f$</span></p><p><strong>Arguments</strong></p><ul><li><code>nf :: Int64</code> is the number of flavours.</li><li><code>nm :: Int64</code> is the number of orbitals.</li><li><code>f :: Int64</code> is the index of the orbital to be taken.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/sphere_obs.jl#L229-L239">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.Density-Tuple{Int64, Int64, Matrix{&lt;:Number}}" href="#Main.FuzzifiED.Density-Tuple{Int64, Int64, Matrix{&lt;:Number}}"><code>Main.FuzzifiED.Density</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function Density(nm :: Int64, nf :: Int64[, mat :: Matrix{&lt;:Number}]) :: SphereObs</code></pre><p>returns the density operator <span>$n=∑_{ff&#39;}ψ^†_{f}M_{ff&#39;}ψ_{f&#39;}$</span></p><p><strong>Arguments</strong></p><ul><li><code>nf :: Int64</code> is the number of flavours.</li><li><code>nm :: Int64</code> is the number of orbitals.</li><li><code>mat :: Int64</code> is the matrix <span>$M_{ff&#39;}$</span>. Facultative, identity matrix <span>$\mathbb{I}$</span> by default.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/sphere_obs.jl#L246-L256">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.Pairing-Tuple{Int64, Int64, Matrix{&lt;:Number}}" href="#Main.FuzzifiED.Pairing-Tuple{Int64, Int64, Matrix{&lt;:Number}}"><code>Main.FuzzifiED.Pairing</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function Pairing(nm :: Int64, nf :: Int64, mat :: Matrix{&lt;:Number}) :: SphereObs</code></pre><p>returns the pair operator <span>$Δ=∑_{ff&#39;}ψ_{f}M_{ff&#39;}ψ_{f&#39;}$</span></p><p><strong>Arguments</strong></p><ul><li><code>nf :: Int64</code> is the number of flavours.</li><li><code>nm :: Int64</code> is the number of orbitals.</li><li><code>mat :: Int64</code> is the matrix <span>$M_{ff&#39;}$</span>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/sphere_obs.jl#L269-L279">source</a></section></article><h2 id="Angular-modes"><a class="docs-heading-anchor" href="#Angular-modes">Angular modes</a><a id="Angular-modes-1"></a><a class="docs-heading-anchor-permalink" href="#Angular-modes" title="Permalink"></a></h2><p>An angular modes object is similar to spherical observables except that it superposes in the rule of Clebsch-Gordan coefficients and does not have the notion of locality.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.AngModes" href="#Main.FuzzifiED.AngModes"><code>Main.FuzzifiED.AngModes</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct AngModes</code></pre><p>is an object that stores angular momentum components of an operator on the sphere <span>$Φ_{lm}$</span> and superposes in the rule of Clebsch-Gordan coefficients. The usage is similar to the spherical observables, except that SphereObs superposes in the rule of spherical harmonics and has the notion of locality</p><p><strong>Fields</strong></p><ul><li><code>l2m :: Int64</code> is twice the maximal angular momentum <span>$2l_{\max}$</span> of the components of the modes object. </li><li><code>get_comp :: Function</code> is a function <code>get_comp(l2 :: Int64, m2 :: Int64) :: Vector{Term}</code> that sends the component specified by a tuple of integers <span>$(2l,2m)$</span> where <span>$|s|\leq l\leq l_{\max}, -l\leq m\leq l$</span> to a list of terms that specifies the expression of the component. </li><li><code>stored_q :: Bool</code> is a boolean that specifies whether or not each component of the modes object is stored.</li><li><code>comps :: Dict{Tuple{Int64, Int64}, Vector{Term}}</code> stores each component of the modes object in the format of a dictionary whose keys are the tuples of integers <span>$(2l,2m)$</span> and values are the lists of terms that specifies the expression of the component. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/ang_modes.jl#L1-L12">source</a></section></article><p>It can be initialised with the following methods </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.AngModes-Tuple{Int64, Function}" href="#Main.FuzzifiED.AngModes-Tuple{Int64, Function}"><code>Main.FuzzifiED.AngModes</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function AngModes(l2m :: Int64, get_comp :: Function) :: AngModes</code></pre><p>initialises the modes object from <span>$2l_{\max}$</span> and the function <span>$(l,m)↦\Phi_{lm}$</span></p><p><strong>Arguments</strong></p><ul><li><code>l2m :: Int64</code> is twice the maximal angular momentum <span>$2l_{\max}$</span> of the components of the modes object. </li><li><code>get_comp :: Function</code> is a function <code>get_comp(l2 :: Int64, m2 :: Int64) :: Vector{Term}</code> that sends the component specified by a tuple of integers <span>$(2l,2m)$</span> where <span>$|s|\leq s\leq l_{\max}, -l\leq m\leq l$</span> to a list of terms that specifies the expression of the component. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/ang_modes.jl#L21-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.AngModes-Tuple{Int64, Dict{Tuple{Int64, Int64}, Vector{Term}}}" href="#Main.FuzzifiED.AngModes-Tuple{Int64, Dict{Tuple{Int64, Int64}, Vector{Term}}}"><code>Main.FuzzifiED.AngModes</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function AngModes(l2m :: Int64, get_comp :: Function) :: AngModes</code></pre><p>initialises the modes object from <span>$2l_{\max}$</span> and a list of <span>$\Phi_{lm}$</span> specified by a dictionary. </p><p><strong>Arguments</strong></p><ul><li><code>l2m :: Int64</code> is twice the maximal angular momentum <span>$2l_{\max}$</span> of the components of the modes object. </li><li><code>comps :: Dict{Tuple{Int64, Int64}, Vector{Term}}</code> stores each component of the modes object in the format of a dictionary whose keys are the tuples of integers <span>$(2l,2m)$</span> and values are the lists of terms that specifies the expression of the component. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/ang_modes.jl#L36-L45">source</a></section></article><p>The following methods explicitly calculates and stores each component</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.StoreComps!-Tuple{AngModes}" href="#Main.FuzzifiED.StoreComps!-Tuple{AngModes}"><code>Main.FuzzifiED.StoreComps!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function StoreComps!(amd :: AngModes) :: Nothing</code></pre><p>calculates and stores each component of the modes object <code>amd</code> and replace the function in <code>amd</code> by the list of calculated components. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/ang_modes.jl#L51-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.StoreComps-Tuple{AngModes}" href="#Main.FuzzifiED.StoreComps-Tuple{AngModes}"><code>Main.FuzzifiED.StoreComps</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function StoreComps(amd :: AngModes) :: AngModes</code></pre><p>calculates and stores each component of the modes object <code>amd</code> and return a new modes object with the list of calculated components. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/ang_modes.jl#L72-L76">source</a></section></article><p>The multiplication, addition and conjugate of an observable is supported </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:*-Tuple{Number, AngModes}" href="#Base.:*-Tuple{Number, AngModes}"><code>Base.:*</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function *(fac :: Number, amd :: AngModes) :: AngModes
function *(amd :: AngModes, fac :: Number) :: AngModes
function /(amd :: AngModes, fac :: Number) :: AngModes
function -(amd :: AngModes) :: AngModes</code></pre><p>enables the multiplication of a mode with a number.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/ang_modes.jl#L93-L100">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:+-Tuple{AngModes, AngModes}" href="#Base.:+-Tuple{AngModes, AngModes}"><code>Base.:+</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function +(obs1 :: AngModes, obs2 :: AngModes) :: AngModes
function -(obs1 :: AngModes, obs2 :: AngModes) :: AngModes</code></pre><p>enables the addition of two modes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/ang_modes.jl#L115-L120">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.adjoint-Tuple{AngModes}" href="#Base.adjoint-Tuple{AngModes}"><code>Base.adjoint</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function adjoint(amd :: AngModes) :: AngModes</code></pre><p>enables the Hermitian conjugate of a spherical mode.</p><p class="math-container">\[\begin{aligned}
    (Φ^†)_{lm}&amp;=(-1)^{l+m}(Φ_{l,-m})^†
\end{aligned}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/ang_modes.jl#L130-L139">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:*-Tuple{AngModes, AngModes}" href="#Base.:*-Tuple{AngModes, AngModes}"><code>Base.:*</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function *(obs1 :: AngModes, obs2 :: AngModes) :: AngModes</code></pre><p>enables the multiplication of two modes in the rule of CG coefficients. </p><p class="math-container">\[    Φ_{lm}=∑_{l_1l_2m_1m_2}δ_{m,m_1+m_2}⟨l_1m_1,l_2m_2|lm⟩Φ_{l_1m_1}Φ_{l_2m_2}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/ang_modes.jl#L147-L154">source</a></section></article><p>One can take out either one or a set of components</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.GetComponent-Tuple{AngModes, Number, Number}" href="#Main.FuzzifiED.GetComponent-Tuple{AngModes, Number, Number}"><code>Main.FuzzifiED.GetComponent</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function GetComponent(amd :: AngModes, l :: Number, m :: Number) :: Vector{Term}</code></pre><p>returns an angular component <span>$Φ_{lm}$</span> of a modes object in the format of a list of terms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/ang_modes.jl#L171-L175">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.FilterL2-Tuple{AngModes, Number}" href="#Main.FuzzifiED.FilterL2-Tuple{AngModes, Number}"><code>Main.FuzzifiED.FilterL2</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function FilterL2(amd :: AngModes, l :: Number) :: AngModes</code></pre><p>returns an angular modes object with modes of a certain total angular momentum filtered out.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/ang_modes.jl#L196-L200">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.FilterComponent-Tuple{AngModes, Any}" href="#Main.FuzzifiED.FilterComponent-Tuple{AngModes, Any}"><code>Main.FuzzifiED.FilterComponent</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function FilterComponent(amd :: AngModes, flt) :: AngModes</code></pre><p>returns an angular modes object with certain modes filtered out.</p><p><strong>Arguments</strong></p><ul><li><code>amd :: AngModes</code> is the original angular modes</li><li><code>flt</code> is the filter function whose input is the pair <span>$(l,m)$</span> and output is a logical that indicates whether this mode is chosen. E.g., if one wants to filter out the modes with angular momentum <code>l0</code>, one should put <code>(l, m) -&gt; l == l0</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/ang_modes.jl#L181-L190">source</a></section></article><p>Three types of operators, <em>viz.</em> electrons and density operators, and pairing operators are built-in.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.ElecMod-Tuple{Int64, Int64, Int64}" href="#Main.FuzzifiED.ElecMod-Tuple{Int64, Int64, Int64}"><code>Main.FuzzifiED.ElecMod</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function ElecMod(nm :: Int64, nf :: Int64, f :: Int64) :: AngModes</code></pre><p>returns the modes of electron annihilation operator <span>$c_m$</span>, with angular momentum <span>$s=(N_m-1)/2$</span></p><p><strong>Arguments</strong></p><ul><li><code>nf :: Int64</code> is the number of flavours.</li><li><code>nm :: Int64</code> is the number of orbitals.</li><li><code>f :: Int64</code> is the index of the orbital to be taken.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/ang_modes.jl#L207-L217">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.PairMod-Tuple{Int64, Int64, Matrix{&lt;:Number}}" href="#Main.FuzzifiED.PairMod-Tuple{Int64, Int64, Matrix{&lt;:Number}}"><code>Main.FuzzifiED.PairMod</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function PairMod(nm :: Int64, nf :: Int64, mat :: Matrix{&lt;:Number}) :: AngModes</code></pre><p>returns the modes of two electrons superposed in the rule of CG coefficients. </p><p class="math-container">\[    Δ_{lm}=∑_{m_1m_2}δ_{m,m_1+m_2}⟨sm_1,sm_2|lm⟩c_{a,m_1}M_{ab}c_{b,m_2}\]</p><p><strong>Arguments</strong></p><ul><li><code>nf :: Int64</code> is the number of flavours.</li><li><code>nm :: Int64</code> is the number of orbitals.</li><li><code>mat :: Int64</code> is the matrix <span>$M_{ff&#39;}$</span>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/ang_modes.jl#L224-L237">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.DenMod-Tuple{Int64, Int64, Matrix{&lt;:Number}}" href="#Main.FuzzifiED.DenMod-Tuple{Int64, Int64, Matrix{&lt;:Number}}"><code>Main.FuzzifiED.DenMod</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function DenMod(nm :: Int64, nf :: Int64, mat :: Matrix{&lt;:Number}) :: AngModes</code></pre><p>returns the modes of electron creation and annihilation superposed in the rule of CG coefficients. </p><p class="math-container">\[    n_{lm}=∑_{m_1m_2}δ_{m,-m_1+m_2}(-1)^{s+m_1}⟨s(-m_1),sm_2|lm⟩c^†_{m_1}c_{m_2}\]</p><p><strong>Arguments</strong></p><ul><li><code>nf :: Int64</code> is the number of flavours.</li><li><code>nm :: Int64</code> is the number of orbitals.</li><li><code>mat :: Int64</code> is the matrix <span>$M_{ff&#39;}$</span>. Facultative, identity matrix <span>$\mathbb{I}$</span> by default.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/0ee7000e1a600b5204fcd631cda52e8894935f2e/src/models/ang_modes.jl#L249-L262">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../itensors/">« ITensors support</a><a class="docs-footer-nextpage" href="../archieve/">Archieved interfaces »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Wednesday 2 October 2024 10:28">Wednesday 2 October 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
