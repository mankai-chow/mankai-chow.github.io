<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Core functions ¬∑ FuzzifiED.jl</title><meta name="title" content="Core functions ¬∑ FuzzifiED.jl"/><meta property="og:title" content="Core functions ¬∑ FuzzifiED.jl"/><meta property="twitter:title" content="Core functions ¬∑ FuzzifiED.jl"/><meta name="description" content="Documentation for FuzzifiED.jl."/><meta property="og:description" content="Documentation for FuzzifiED.jl."/><meta property="twitter:description" content="Documentation for FuzzifiED.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/themes/serif.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="FuzzifiED.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">FuzzifiED.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../example/">Example</a></li><li class="is-active"><a class="tocitem" href>Core functions</a><ul class="internal"><li><a class="tocitem" href="#Environment-parameters"><span>Environment parameters</span></a></li><li><a class="tocitem" href="#Quantum-numbers"><span>Quantum numbers</span></a></li><li><a class="tocitem" href="#Configurations"><span>Configurations</span></a></li><li><a class="tocitem" href="#Basis"><span>Basis</span></a></li><li><a class="tocitem" href="#Term"><span>Term</span></a></li><li><a class="tocitem" href="#Operator"><span>Operator</span></a></li><li><a class="tocitem" href="#Sparse-matrix"><span>Sparse matrix</span></a></li><li><a class="tocitem" href="#Entanglement"><span>Entanglement</span></a></li><li><a class="tocitem" href="#File-operations"><span>File operations</span></a></li></ul></li><li><a class="tocitem" href="../itensors/">ITensors support</a></li><li><a class="tocitem" href="../models/">Built-in models</a></li><li><a class="tocitem" href="../archieve/">Archieved interfaces</a></li><li><a class="tocitem" href="../releases/">Releases</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Core functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Core functions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/mankai-chow/fuzzifi_ed" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/mankai-chow/fuzzifi_ed/blob/main/docs/src/core.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Core-functions"><a class="docs-heading-anchor" href="#Core-functions">Core functions</a><a id="Core-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Core-functions" title="Permalink"></a></h1><h2 id="Environment-parameters"><a class="docs-heading-anchor" href="#Environment-parameters">Environment parameters</a><a id="Environment-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Environment-parameters" title="Permalink"></a></h2><p>The following environment parameters defines how FuzzifiED works, <em>viz.</em> whether it outputs logs, how many threads it uses and where it reads its libraries. In general, you can keep it at default. </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.SilentStd" href="#Main.FuzzifiED.SilentStd"><code>Main.FuzzifiED.SilentStd</code></a> ‚Äî <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">SilentStd :: Bool = false</code></pre><p>a flag to determine whether logs of the FuzzifiED functions should be turned off. False by default. If you want to evaluate without log, put <code>FuzzifiED.SilentStd = true</code>. This parameter can be defined for each process separately. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/param.jl#L2-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.NumThreads" href="#Main.FuzzifiED.NumThreads"><code>Main.FuzzifiED.NumThreads</code></a> ‚Äî <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">NumThreads :: Int = Threads.nthreads()</code></pre><p>an integer to define how many threads OpenMP uses. By default, it is the same as the number of threads in Julia. If you use Jupyter notebooks, which by default uses one core only, you may need to define this by hand, <em>e.g.</em>, <code>FuzzifiED.NumThreads = 8</code>. This parameter can be defined for each process separately. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/param.jl#L16-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.Libpath" href="#Main.FuzzifiED.Libpath"><code>Main.FuzzifiED.Libpath</code></a> ‚Äî <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">Libpath :: String = FuzzifiED_jll.LibpathFuzzifiED</code></pre><p>define where the Fortran library are compiled. You do not need to modify that by yourself. However, if you compile the Fortran codes by yourself, you need to point this to your compiled library. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/param.jl#L9-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.ElementType" href="#Main.FuzzifiED.ElementType"><code>Main.FuzzifiED.ElementType</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ElementType :: DataType = ComplexF64</code></pre><p>set the default type of the operator elements, either <code>ComplexF64</code> or <code>Float64</code>. <code>ComplexF64</code> by default. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/param.jl#L23-L27">source</a></section></article><h2 id="Quantum-numbers"><a class="docs-heading-anchor" href="#Quantum-numbers">Quantum numbers</a><a id="Quantum-numbers-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-numbers" title="Permalink"></a></h2><p>FuzzifiED implements diagonal and off-diagonal quantum numbers. They are defined as</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.QNDiag" href="#Main.FuzzifiED.QNDiag"><code>Main.FuzzifiED.QNDiag</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct QNDiag</code></pre><p>records the information of a diagonal <span>$\mathrm{U}(1)$</span> or <span>$‚Ñ§_p$</span> quantum number in the form of a symmetry charge</p><p class="math-container">\[Q=‚àë_{o=1}^{N_o}q_on_o\]</p><p>or</p><p class="math-container">\[Q=‚àë_{o=1}^{N_o}q_on_o\ \mathrm{mod}\ p\]</p><p>where <span>$i=1,‚Ä¶,N_U$</span> is the index of quantum number, <span>$o$</span> is the index of orbital, <span>$n_o=c^‚Ä†_oc_o$</span>, and <span>$q_o$</span> is a set of coefficients that must be integer valued.</p><p><strong>Fields</strong></p><ul><li><code>name :: String</code> is the name of the diagonal quantum number </li><li><code>charge :: Vector{Int64}</code> is the symmetry charge <span>$q_o$</span> of each orbital</li><li><code>modul :: Vector{Int64}</code> is the modulus <span>$p$</span>, set to 1 for <span>$\mathrm{U}(1)$</span> QNDiags. </li></ul><p><strong>Initialisation</strong></p><p>It can be initialised by the following method</p><pre><code class="language-julia hljs">QNDiag([name :: String, ]charge :: Vector{Int64}[, modul :: Int64]) :: QNDiag</code></pre><p>The arguments <code>name</code> and <code>modul</code> is facultative. By default <code>name</code> is set to <code>&quot;QN&quot;</code> and <code>modul</code> is set to 1. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/qn.jl#L1-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.QNOffd" href="#Main.FuzzifiED.QNOffd"><code>Main.FuzzifiED.QNOffd</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct QNOffd</code></pre><p>records the information of an off-diagonal <span>$‚Ñ§_p$</span> quantum number in the form of a discrete transformation</p><p class="math-container">\[ùíµ:\ c_o‚Ü¶ Œ±_o^* c^{(p_o)}_{œÄ_o},‚ÄÉ c_o^‚Ä†‚Ü¶ Œ±_o c^{(1-p_o)}_{œÄ_o}\]</p><p>where we use a notation <span>$c^{(1)}=c^‚Ä†$</span> and <span>$c^{0}=c$</span> for convenience, <span>$œÄ_o$</span> is a permutation of <span>$1,‚Ä¶,N_o$</span>, <span>$Œ±_o$</span> is a coefficient, and <span>$p_o$</span> specified whether or not particle-hole transformation is performed for the orbital. Note that one must guarentee that all these transformations commute with each other and also commute with the diagonal QNs. </p><p><strong>Arguments</strong></p><ul><li><code>perm :: Vector{Int64}</code> is a length-<span>$N_o$</span> vector that records the permutation <span>$œÄ_o$</span>.</li><li><code>ph :: Vector{Int64}</code> is a length-<span>$N_o$</span> vector that records <span>$p_o$</span> to determine whether or not to perform a particle-hole transformation</li><li><code>fac :: Vector{ComplexF64}</code> is a length-<span>$N_o$</span> vector that records the factor <span>$Œ±_o$</span> in the transformation.</li><li><code>cyc :: Int64</code> is the cycle <span>$p$</span>. </li></ul><p><strong>Initialisation</strong></p><p>It can be initialised by the following method</p><pre><code class="language-julia hljs">QNOffd(perm :: Vector{Int64}[, ph :: Vector{Int64}][, fac :: Vector{ComplexF64}][, cyc :: Int64]) :: QNOffd
QNOffd(perm :: Vector{Int64}, ph_q :: Bool[, fac :: Vector{ComplexF64}]) :: QNOffd</code></pre><p>The arguments <code>ph</code>, <code>fac</code> and <code>cyc</code> are facultative. By default <code>ph</code> is set all 0, <code>fac</code> is set to all 1 and <code>cyc</code> is set to 2. If <code>ph_q</code> is a bool and true, then <code>ph</code> is set to all 1. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/qn.jl#L85-L110">source</a></section></article><p>The QNDiag can be added or multiplied by a number </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:+-Tuple{QNDiag, QNDiag}" href="#Base.:+-Tuple{QNDiag, QNDiag}"><code>Base.:+</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function +(qnd1 :: QNDiag, qnd2 :: QNDiag) :: QNDiag 
function -(qnd1 :: QNDiag, qnd2 :: QNDiag) :: QNDiag</code></pre><p>returns the sum or substraction of two QNDiags, whose name is the samea as <code>qnd1</code>, charge is the same as <code>qnd1 ¬± qnd2</code>, and modulus is the GCD of <code>qnd1</code> and <code>qnd2</code>. If <code>qnd1</code> and <code>qnd2</code> are both <span>$‚Ñ§_p$</span> quantum numbers and their modulus are coprime, a trivial QNDiag will be returned. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/qn.jl#L63-L68">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:*-Tuple{Int64, QNDiag}" href="#Base.:*-Tuple{Int64, QNDiag}"><code>Base.:*</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function *(fac :: Int64, qnd :: QNDiag) :: QNDiag 
function *(qnd :: QNDiag, fac :: Int64) :: QNDiag 
function √∑(qnd :: QNDiag, fac :: Int64) :: QNDiag 
function -(qnd :: QNDiag) :: QNDiag</code></pre><p>returns the QNDiag multiplied or divided by an integer factor, where the charge is multiplied or integer-divided by the factor. For <span>$‚Ñ§_p$</span> quantum numbers, their modulus will be multiplied or integer-divided by the absolute value. If <code>qnd.modul √∑ abs(fac) ‚â§ 1</code>, a trivial QNDiag will be returned.  </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/qn.jl#L37-L44">source</a></section></article><p>The QNOffd can be composed</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:*-Tuple{QNOffd, QNOffd}" href="#Base.:*-Tuple{QNOffd, QNOffd}"><code>Base.:*</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function *(qnf1 :: QNOffd, qnf2 :: QNOffd) :: QNOffd</code></pre><p>returns the composition of two QNOffd transformations. The cycle is set to be the LCM of two QNOffds</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/qn.jl#L123-L127">source</a></section></article><h2 id="Configurations"><a class="docs-heading-anchor" href="#Configurations">Configurations</a><a id="Configurations-1"></a><a class="docs-heading-anchor-permalink" href="#Configurations" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.Confs" href="#Main.FuzzifiED.Confs"><code>Main.FuzzifiED.Confs</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct Confs</code></pre><p>This type stores all the configurations that respects the diagonal quantum numbers (QNDiag) and also a table to inversely look up the index from the configuration. </p><p><strong>Fields</strong></p><ul><li><code>no :: Int64</code> is the number of orbital*flavour.</li><li><code>ncf :: Int64</code> is the number of configurations.</li><li><code>conf :: Vector{Int64}</code> is an array of length <code>ncf</code> containing all the configurations. Each configuration is expressed in a binary number. If the <code>o-1</code>-th bit of <code>conf[i]</code> is 1, then the <code>o</code>-th orbital in the <code>i</code>-th configuration is occupied ; if the bit is 0, then the orbital is empty. </li><li><code>nor :: Int64</code>, <code>lid :: Vector{Int64}</code> and <code>rid :: Vector{Int64}</code> contain the information of Lin table that is used to inversely look up the index <code>i</code> from the configuration. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/confs.jl#L1-L12">source</a></section></article><p>It can be generated from the QNDiags.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.Confs-Tuple{Int64, Vector{Int64}, Vector{QNDiag}}" href="#Main.FuzzifiED.Confs-Tuple{Int64, Vector{Int64}, Vector{QNDiag}}"><code>Main.FuzzifiED.Confs</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function Confs(no :: Int64, secd :: Vector{Int64}, qnd :: Vector{QNDiag} ; nor :: Int64 = div(no, 2), modul :: Vector{Int64}, num_th :: Int64, disp_std :: Bool) :: Confs</code></pre><p>generates the configurations from the list of QNDiags. </p><p><strong>Arguments</strong></p><ul><li><code>no :: Int64</code> is the number of orbital*flavour <span>$N_o$</span>.</li><li><code>secd :: Vector{Int64}</code> is the set of <span>$Q_i$</span> for the selected configurations in the sector.</li><li><code>qnd :: Vector{QNDiag}</code> is the set of <a href="#Main.FuzzifiED.QNDiag">QNDiags</a>. </li><li><code>nor :: Int64</code> is the number of less significant bits used to generate the Lin table. Facultative, <span>$N_o/2$</span> by default.</li><li><code>num_th :: Int64</code>, the number of threads. Facultative, <code>NumThreads</code> by default. </li><li><code>disp_std :: Bool</code>, whether or not the log shall be displayed. Facultative, <code>!SilentStd</code> by default. </li></ul><p><strong>Output</strong></p><ul><li><code>cfs :: Confs</code> is a <a href="#Main.FuzzifiED.Confs">Confs</a> object.</li></ul><p><strong>Note</strong></p><p>If your <code>qnd</code> has negative entries, QNDiags must contain the number of electrons.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/confs.jl#L23-L44">source</a></section></article><p>The inverse look-back for a configuration can be done by </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.GetConfId-Tuple{Confs, Int64}" href="#Main.FuzzifiED.GetConfId-Tuple{Confs, Int64}"><code>Main.FuzzifiED.GetConfId</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">GetConfId(cfs :: Confs, cf :: Int64) :: Int64</code></pre><p>inversely look up the index from the configuration</p><p><strong>Arguments</strong></p><ul><li><code>cfs :: Confs</code> stores the configurations.</li><li><code>cf :: Int64</code> stores the configuration to be looked-up expressed in a binary number. If the <code>o-1</code>-th bit of <code>conf[i]</code> is 1, then the <code>o</code>-th orbital in the <code>i</code>-th configuration is occupied ; if the bit is 0, then the orbital is empty. </li></ul><p><strong>Output</strong></p><ul><li><code>id :: Int64</code> is the id of the configuration such that <code>cfs.conf[id] == cf</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/confs.jl#L91-L104">source</a></section></article><h2 id="Basis"><a class="docs-heading-anchor" href="#Basis">Basis</a><a id="Basis-1"></a><a class="docs-heading-anchor-permalink" href="#Basis" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.Basis" href="#Main.FuzzifiED.Basis"><code>Main.FuzzifiED.Basis</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct Basis</code></pre><p>This type stores the information of the basis that respects both diagonal and off-diagonal quantum numbers. The states in the basis is in the form </p><p class="math-container">\[|I‚ü©=Œª_{i_{I1}}|i_{I1}‚ü©+Œª_{i_{I2}}|i_{I2}‚ü©+‚ãØ+Œª_{i_{Im_I}}|i_{Im_I}‚ü©\]</p><p>where <span>$|i‚ü©$</span> is a direct product state, <em>i.e.</em>, the configurations <span>$|i_{Ik}‚ü©$</span> are grouped into a state <span>$|I‚ü©$</span>. </p><p><strong>Fields</strong></p><ul><li><code>cfs :: Confs</code> stores the configurations that respect the QNDiags ;</li><li><code>dim :: Int64</code> is the dimension of the basis ;</li><li><code>szz :: Int64</code> records the maximum size <span>$\max m_g$</span> of groups;</li><li><code>cfgr :: Vector{Int64}</code> is a vector of length <code>cfs.ncf</code> and records which group <span>$|I‚ü©$</span> each configuration <span>$|i‚ü©$</span> belong to ;</li><li><code>cffac :: Vector{ComplexF64}</code> is a vector of length <code>cfs.ncf</code> and records the coefficients <span>$Œª_i$</span> of each configuration ;</li><li><code>grel :: Matrix{Int64}</code> is a <code>szz</code>*<code>dim</code> matrix that records the configurations in each group <span>$|i_{Ik}‚ü© (k = 1,‚Ä¶,m_I)$</span></li><li><code>grsz :: Vector{Int64}</code> is a vector of length <code>dim</code> that records the size <span>$m_I$</span> of each group.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/basis.jl#L1-L18">source</a></section></article><p>It can be generated by the following methods.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.Basis-Tuple{Confs, Vector{ComplexF64}, Vector{QNOffd}}" href="#Main.FuzzifiED.Basis-Tuple{Confs, Vector{ComplexF64}, Vector{QNOffd}}"><code>Main.FuzzifiED.Basis</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function Basis(cfs :: Confs, secf :: Vector{ComplexF64}, qnf :: Vector{QNOffd} ; num_th :: Int64, disp_std :: Bool) :: Basis</code></pre><p>generates the basis that respects the off-diagonal <span>$‚Ñ§_p$</span> quantum numbers (QNOffd)</p><p><strong>Arguments</strong></p><ul><li><code>cfs :: Confs</code> is the diagonal QN‚Äìpreserving configurations ;</li><li><code>secf :: Vector{ComplexF64}</code> is a vector of length the same as the number of discrete symmetries that records the eigenvalue of each transformation in the sector ;</li><li><code>qnf :: Vector{QNOffd}</code> is a vector of off-diagonal quantum numbers. </li><li><code>num_th :: Int64</code>, the number of threads. Facultative, <code>NumThreads</code> by default. </li><li><code>disp_std :: Bool</code>, whether or not the log shall be displayed. Facultative, <code>!SilentStd</code> by default. </li></ul><p><strong>Output</strong></p><ul><li><code>bs :: Basis</code> is the resulting <a href="#Basis">Basis</a> object</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/basis.jl#L30-L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.Basis-Tuple{Confs}" href="#Main.FuzzifiED.Basis-Tuple{Confs}"><code>Main.FuzzifiED.Basis</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function Basis(cfs :: Confs) :: Basis</code></pre><p>Generate a basis from the configurations without off-diagonal <span>$‚Ñ§_n$</span> symmetries.</p><p><strong>Arguments</strong></p><ul><li><code>cfs :: Confs</code> is the diagonal QN‚Äìpreserving configurations ;</li></ul><p><strong>Output</strong></p><ul><li><code>bs :: Basis</code> is the resulting <code>Basis</code> object</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/basis.jl#L77-L89">source</a></section></article><p>The look-back of the weight of a configuration in a state can be done by </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.GetConfWeight-Tuple{Basis, Union{Vector{ComplexF64}, Vector{Float64}}, Int64}" href="#Main.FuzzifiED.GetConfWeight-Tuple{Basis, Union{Vector{ComplexF64}, Vector{Float64}}, Int64}"><code>Main.FuzzifiED.GetConfWeight</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">GetConfWeight(bs :: Basis, st :: Vector{&lt;:Number}, cf :: Int64) :: ComplexF64</code></pre><p>looks up a the weight of a configuration in a state. </p><p><strong>Arguments</strong></p><ul><li><code>bs :: Basis</code> is the basis of the state ; </li><li><code>st :: Vector{ComplexF64}</code> or <code>st :: Vector{Float64}</code> is a vector of length <code>bs.dim</code> that stores the state ; </li><li><code>cf :: Int64</code> stores the configuration to be looked-up expressed in a binary number. If the <code>o-1</code>-th bit of <code>conf[i]</code> is 1, then the <code>o</code>-th orbital in the <code>i</code>-th configuration is occupied ; if the bit is 0, then the orbital is empty. </li></ul><p><strong>Output</strong></p><ul><li>The weight of the configuration in the state </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/basis.jl#L101-L116">source</a></section></article><h2 id="Term"><a class="docs-heading-anchor" href="#Term">Term</a><a id="Term-1"></a><a class="docs-heading-anchor-permalink" href="#Term" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.Term" href="#Main.FuzzifiED.Term"><code>Main.FuzzifiED.Term</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct Term</code></pre><p>A <code>Term</code> object records a term that looks like <span>$Uc^{(p_1)}_{o_1}c^{(p_2)}_{o_2}‚Ä¶ c^{(p_l)}_{o_l}$</span> in an operator</p><p><strong>Fields</strong></p><ul><li><code>coeff :: ComplexF64</code> records the coefficient <span>$U$</span></li><li><code>cstr :: Vector{Int64}</code> is a length-<span>$2l$</span> vector <span>$(p_1,o_1,p_2,o_2,‚Ä¶ p_l,o_l)$</span> recording the operator string</li></ul><p><strong>Method</strong></p><p>It can be generated by the function</p><pre><code class="nohighlight hljs">function Term(coeff :: ComplexF64, cstr :: Vector{Int64}) :: ComplexF64</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/term.jl#L1-L15">source</a></section></article><p>The product of terms with a number, the sum and product of terms, adjoint and particle-hole transformation are defined</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:*-Tuple{Number, Vector{Term}}" href="#Base.:*-Tuple{Number, Vector{Term}}"><code>Base.:*</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function *(fac :: Number, tms :: Vector{Term}) :: Vector{Term}
function -(tms :: Vector{Term}) :: Vector{Term}
function *(tms :: Vector{Term}, fac :: Number) :: Vector{Term}
function /(tms :: Vector{Term}, fac :: Number) :: Vector{Term}</code></pre><p>Return the product of a collection of terms with a number. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/term.jl#L25-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:+-Tuple{Vector{Term}, Vector{Term}}" href="#Base.:+-Tuple{Vector{Term}, Vector{Term}}"><code>Base.:+</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function +(tms1 :: Vector{Term}, tms2 :: Vector{Term}) :: Vector{Term}
function -(tms1 :: Vector{Term}, tms2 :: Vector{Term}) :: Vector{Term}</code></pre><p>Return the naive sum of two series of terms by taking their union. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/term.jl#L46-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:*-Tuple{Vector{Term}, Vector{Term}}" href="#Base.:*-Tuple{Vector{Term}, Vector{Term}}"><code>Base.:*</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function *(tms1 :: Vector{Term}, tms2 :: Vector{Term}) :: Vector{Term}
function ^(tms :: Vector{Term}, pow :: Int64) :: Vector{Term}</code></pre><p>Return the naive product of two series of terms or the power of one terms. The number of terms equals the product of the number of terms in <code>tms1</code> and <code>tms2</code>. For each term in <code>tms1</code> <span>$Uc^{(p_1)}_{o_1}‚Ä¶$</span> and <code>tms2</code> <span>$U&#39;c^{(p&#39;_1)}_{o&#39;_1}‚Ä¶$</span>, a new term is formed by taking <span>$UU&#39;c^{(p_1)}_{o_1}‚Ä¶ c^{(p&#39;_1)}_{o&#39;_1}‚Ä¶$</span></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/term.jl#L63-L68">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.adjoint-Tuple{Vector{Term}}" href="#Base.adjoint-Tuple{Vector{Term}}"><code>Base.adjoint</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function adjoint(tm :: Term) :: Term
function adjoint(tms :: Vector{Term}) :: Vector{Term}</code></pre><p>Return the Hermitian conjugate of a series of terms. For each term <span>$Uc^{(p_1)}_{o_1}c^{(p_2)}_{o_2}‚Ä¶ c^{(p_l)}_{o_l}$</span>, the adjoint is <span>$\bar{U}c^{(1-p_l)}_{o_l}‚Ä¶ c^{(1-p_2)}_{o_2}c^{(1-p_1)}_{o_1}$</span></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/term.jl#L89-L94">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.ParticleHole-Tuple{Vector{Term}}" href="#Main.FuzzifiED.ParticleHole-Tuple{Vector{Term}}"><code>Main.FuzzifiED.ParticleHole</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function ParticleHole(tm :: Term) :: Term
function ParticleHole(tms :: Vector{Term}) :: Vector{Term}</code></pre><p>Return the particle-hole transformation of a series of terms. For each term <span>$Uc^{(p_1)}_{o_1}c^{(p_2)}_{o_2}‚Ä¶ c^{(p_l)}_{o_l}$</span>, the transformation results in <span>$Uc^{(1-p_1)}_{o_1}c^{(1-p_2)}_{o_2}‚Ä¶c^{(1-p_l)}_{o_l}$</span></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/term.jl#L104-L109">source</a></section></article><p>The terms can be simplified by </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.NormalOrder-Tuple{Term}" href="#Main.FuzzifiED.NormalOrder-Tuple{Term}"><code>Main.FuzzifiED.NormalOrder</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function NormalOrder(tm :: Term) :: Vector{Term}</code></pre><p>rearrange a term such that </p><ul><li>the creation operators must be commuted in front of the annihilation operator </li><li>the orbital index of the creation operators are in ascending order and the annihilation operators in descending order. </li></ul><p>return a list of terms whose result is equal to the original term. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/term.jl#L116-L123">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.SimplifyTerms-Tuple{Vector{Term}}" href="#Main.FuzzifiED.SimplifyTerms-Tuple{Vector{Term}}"><code>Main.FuzzifiED.SimplifyTerms</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function SimplifyTerms(tms :: Vector{Term} ; cutoff :: Float64 = eps(Float64)) :: Vector{Term}</code></pre><p>simplifies the sum of terms such that </p><ul><li>each term is normal ordered,</li><li>like terms are combined, and terms with zero coefficients are removed.</li></ul><p><strong>Argument</strong></p><ul><li><code>cutoff :: Float64</code> is the cutoff such that terms with smaller absolute value of coefficients will be neglected. Facultative, <code>eps(Float64)</code> by default. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/term.jl#L162-L173">source</a></section></article><h2 id="Operator"><a class="docs-heading-anchor" href="#Operator">Operator</a><a id="Operator-1"></a><a class="docs-heading-anchor-permalink" href="#Operator" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.Operator" href="#Main.FuzzifiED.Operator"><code>Main.FuzzifiED.Operator</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct Operator</code></pre><p>An <code>Operator</code> object records the sum of terms together with information about its symmetry and the basis of the state it acts on and the basis of the resulting state.</p><p><strong>Fields</strong></p><ul><li><code>bsd :: Basis</code> is the basis of the initial state ;</li><li><code>bsf :: Basis</code> is the basis of the final state ;</li><li><code>red_q :: Int64</code> is a flag that records whether or not the conversion to a sparse martrix can be simplified : if <code>bsd</code> and <code>bsf</code> have exactly the same set of quantum numbers, and the operator fully respects the symmetries, and all the elements in <code>bsd.cffac</code> and <code>bsf.cffac</code> has the same absolute value, then <code>red_q = 1</code> ; otherwise <code>red_q = 0</code> ; </li><li><code>sym_q :: Int64</code> records the symmetry of the operator : if the matrix is Hermitian, then <code>sym_q = 1</code> ; if it is symmetric, then <code>sym_q = 2</code> ; otherwise <code>sym_q = 0</code> ;</li><li><code>ntm :: Int64</code> is the number of terms ;</li><li><code>nc :: Int64</code> is the maximum number of operators in an operator string</li><li><code>cstrs :: Matrix{Int64}</code> is a matrix recording the operator string of each term. Each column corresponds to a term and is padded to the maximum length with <code>-1</code>&#39;s.</li><li><code>coeffs :: Vector{ComplexF64}</code> corresponds to the coefficients in each term.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/operator.jl#L1-L15">source</a></section></article><p>It can be generated by the following methods.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.Operator-Tuple{Basis, Basis, Vector{Term}}" href="#Main.FuzzifiED.Operator-Tuple{Basis, Basis, Vector{Term}}"><code>Main.FuzzifiED.Operator</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function Operator(bsd :: Basis[, bsf :: Basis], terms :: Vector{Term} ; red_q :: Int64, sym_q :: Int64, num_th :: Int64, disp_std :: Bool) :: Operator</code></pre><p>generates an operator object from a series of terms. </p><p><strong>Arguments</strong></p><ul><li><code>bsd :: Basis</code> is the basis of the initial state ;</li><li><code>bsf :: Basis</code> is the basis of the final state. Facultative, the same as <code>bsd</code> by default. </li><li><code>terms :: Vector{Term}</code> records the terms ; </li><li><code>red_q :: Int64</code> is a flag that records whether or not the conversion to a sparse martrix can be simplified : if <code>bsd</code> and <code>bsf</code> have exactly the same set of quantum numbers, and the operator fully respects the symmetries, and all the elements in <code>bsd.cffac</code> and <code>bsf.cffac</code> has the same absolute value, then <code>red_q = 1</code> ; otherwise <code>red_q = 0</code> ; Facultative, if <code>bsf</code> is not given, 1 by default, otherwise 0 by default.</li><li><code>sym_q :: Int64</code> records the symmetry of the operator : if the matrix is Hermitian, then <code>sym_q = 1</code> ; if it is symmetric, then <code>sym_q = 2</code> ; otherwise <code>sym_q = 0</code>. Facultative, if <code>bsf</code> is not given, 1 by default, otherwise 0 by default.</li><li><code>num_th :: Int64</code>, the number of threads. Facultative, <code>NumThreads</code> by default. </li><li><code>disp_std :: Bool</code>, whether or not the log shall be displayed. Facultative, <code>!SilentStd</code> by default. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/operator.jl#L28-L42">source</a></section></article><p>The product of an operator on a state and the inner product of a final state, an operator and an initial state can be calculated by</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:*-Tuple{Operator, Vector{ComplexF64}}" href="#Base.:*-Tuple{Operator, Vector{ComplexF64}}"><code>Base.:*</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function *(op :: Operator, st_d :: Vector{ComplexF64} ; num_th :: Int64, disp_std :: Bool) :: Vector{ComplexF64}
function *(op :: Operator, st_d :: Vector{Float64} ; num_th :: Int64, disp_std :: Bool) :: Vector{Float64}</code></pre><p>Measure the action of an operator on a state. <code>st_d</code> must be of length <code>op.bsd.dim</code>. Returns a vector of length <code>op.bsf.dim</code> that represents the final state.</p><p><strong>Facultative arguments</strong></p><ul><li><code>num_th :: Int64</code>, the number of threads. Facultative, <code>NumThreads</code> by default. </li><li><code>disp_std :: Bool</code>, whether or not the log shall be displayed. Facultative, <code>!SilentStd</code> by default. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/operator.jl#L54-L65">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:*-Tuple{LinearAlgebra.Adjoint{ComplexF64, Vector{ComplexF64}}, Operator, Vector{ComplexF64}}" href="#Base.:*-Tuple{LinearAlgebra.Adjoint{ComplexF64, Vector{ComplexF64}}, Operator, Vector{ComplexF64}}"><code>Base.:*</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function *(st_fp :: LinearAlgebra.Adjoint{ComplexF64, Vector{ComplexF64}}, op :: Operator, st_d :: Vector{ComplexF64} ; num_th :: Int64, disp_std :: Bool) :: ComplexF64
function *(st_fp :: LinearAlgebra.Adjoint{Float64, Vector{Float64}}, op :: Operator, st_d :: Vector{Float64} ; num_th :: Int64, disp_std :: Bool) :: Float64</code></pre><p>Measuring the inner product between two states and an operator. <code>st_d</code> must be of length <code>op.bsd.dim</code> and <code>st_fp</code> must be of length <code>op.bsf.dim</code>, and <code>st_fp</code> must be an adjoint. </p><p><strong>Facultative arguments</strong></p><ul><li><code>num_th :: Int64</code>, the number of threads. Facultative, <code>NumThreads</code> by default. </li><li><code>disp_std :: Bool</code>, whether or not the log shall be displayed. Facultative, <code>!SilentStd</code> by default. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/operator.jl#L84-L94">source</a></section></article><h2 id="Sparse-matrix"><a class="docs-heading-anchor" href="#Sparse-matrix">Sparse matrix</a><a id="Sparse-matrix-1"></a><a class="docs-heading-anchor-permalink" href="#Sparse-matrix" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.OpMat" href="#Main.FuzzifiED.OpMat"><code>Main.FuzzifiED.OpMat</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct OpMat{ComplexF64}
mutable struct OpMat{Float64}</code></pre><p>This type stores a sparse matrix in the same form as <code>SparseMatrixCSC</code> in <code>SparseArrays</code>. If the matrix is Hermitian or symmetric, only the lower triangle is stored. </p><p><strong>Fields</strong></p><ul><li><code>dimd :: Int64</code> and <code>dimf :: Int64</code> are the number of columns and rows of the matrix ;</li><li><code>symq :: Int64</code> records whether or not the matrix is Hermitian or symmetric ;</li><li><code>nel :: Int64</code> records the number of elements ;</li><li><code>colptr :: Vector{Int64}</code>, <code>rowid :: Vector{Int64}</code> and <code>elval :: Vector{ComplexF64}</code> records the elements of the sparse matrix as in the <code>SparseMatrixCSC</code> elements of Julia. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/opmat.jl#L1-L12">source</a></section></article><p>It can be generated by the following methods.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.OpMat-Tuple{Operator}" href="#Main.FuzzifiED.OpMat-Tuple{Operator}"><code>Main.FuzzifiED.OpMat</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function OpMat[{type}](op :: Operator ; num_th :: Int64, disp_std :: Bool) :: OpMat{type}</code></pre><p>Generates the sparse matrix from the operator. The parameter <code>type</code> is either <code>Float64</code> or <code>ComplexF64</code> ; it is facultative, given by <code>ElementType</code> by default. </p><p><strong>Arguments</strong></p><ul><li><code>op :: Operator</code> is the operator ;</li><li><code>type :: DataType</code> specifies the type of the matrix. It can either be <code>ComplexF64</code> or <code>Float64</code>. Facultative, the same as <code>ElementType</code> by default</li><li><code>num_th :: Int64</code>, the number of threads. Facultative, <code>NumThreads</code> by default. </li><li><code>disp_std :: Bool</code>, whether or not the log shall be displayed. Facultative, <code>!SilentStd</code> by default. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/opmat.jl#L58-L69">source</a></section></article><p>The lowest eigenstates of the sparse matrix can be calculated by </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.GetEigensystem-Tuple{OpMat{ComplexF64}, Int64}" href="#Main.FuzzifiED.GetEigensystem-Tuple{OpMat{ComplexF64}, Int64}"><code>Main.FuzzifiED.GetEigensystem</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function GetEigensystem(mat :: OpMat{ComplexF64}, nst :: Int64 ; tol :: Float64, ncv :: Int64, initvec :: Vector{ComplexF64}, num_th :: Int64, disp_std :: Bool) :: Tuple{Vector{ComplexF64}, Matrix{ComplexF64}}
function GetEigensystem(mat :: OpMat{Float64}, nst :: Int64 ; tol :: Float64, ncv :: Int64, initvec :: Vector{Float64}, num_th :: Int64, disp_std :: Bool) :: Tuple{Vector{Float64}, Matrix{Float64}}</code></pre><p>calls the Arpack package to calculate the lowest eigenstates of sparse matrix. </p><p><strong>Arguments</strong></p><ul><li><code>mat :: OpMat{ComplexF64}</code> or <code>mat :: OpMat{Float64}</code> is the matrix ;</li><li><code>nst :: Int64</code> is the number of eigenstates to be calculated ;</li><li><code>tol :: Float64</code> is the tolerence for the Arpack process. The default value is <code>1E-8</code> ;</li><li><code>ncv :: Int64</code> is an auxiliary parameter needed in the Arpack process. The default value is <code>max(2 * nst, nst + 10)</code></li><li><code>initvec :: Vector{ComplexF64}</code> or <code>initvec :: Vector{Float64}</code> is the initial vector. If empty, a random initialisation shall be used. Facultative, empty by default. </li><li><code>num_th :: Int64</code>, the number of threads. Facultative, <code>NumThreads</code> by default. </li><li><code>disp_std :: Bool</code>, whether or not the log shall be displayed. Facultative, <code>!SilentStd</code> by default. </li></ul><p><strong>Output</strong></p><ul><li>A length-<code>nst</code> array that has the same type as <code>mat</code> recording the eigenvalues, and </li><li>A <code>dimd</code>*<code>nst</code> matrix that has the same type as <code>mat</code> where every column records an eigenstate. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/opmat.jl#L73-L93">source</a></section></article><p>The product of an operator on a state and the inner product of a final state, an operator and an initial state can be calculated by</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:*-Tuple{OpMat{ComplexF64}, Vector{ComplexF64}}" href="#Base.:*-Tuple{OpMat{ComplexF64}, Vector{ComplexF64}}"><code>Base.:*</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function *(mat :: OpMat{ComplexF64}, st_d :: Vector{ComplexF64} ; num_th :: Int64) :: Vector{ComplexF64}
function *(mat :: OpMat{Float64}, st_d :: Vector{Float64} ; num_th :: Int64) :: Vector{Float64}</code></pre><p>Measure the action of a sparse matrix on a state. <code>st_d</code> must be of length <code>mat.dimd</code>. Returns a vector of length <code>mat.dimf</code> that represents the final state. </p><p><strong>Facultative argument</strong></p><ul><li><code>num_th :: Int64</code>, the number of threads. Facultative, <code>NumThreads</code> by default. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/opmat.jl#L115-L124">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:*-Tuple{LinearAlgebra.Adjoint{ComplexF64, Vector{ComplexF64}}, OpMat{ComplexF64}, Vector{ComplexF64}}" href="#Base.:*-Tuple{LinearAlgebra.Adjoint{ComplexF64, Vector{ComplexF64}}, OpMat{ComplexF64}, Vector{ComplexF64}}"><code>Base.:*</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function *(st_fp :: LinearAlgebra.Adjoint{ComplexF64, Vector{ComplexF64}}, mat :: OpMat{ComplexF64}, st_d :: Vector{ComplexF64} ; num_th :: Int64) :: ComplexF64
function *(st_fp :: LinearAlgebra.Adjoint{Float64, Vector{Float64}}, mat :: OpMat{Float64}, st_d :: Vector{Float64} ; num_th :: Int64) :: Float64</code></pre><p>Measuring the inner product between two states and a sparse matrix. <code>st_d</code> must be of length <code>mat.dimd</code> and <code>st_fp</code> must be of length <code>mat.dimf</code>, and <code>st_fp</code> must be an adjoint. </p><p><strong>Facultative argument</strong></p><ul><li><code>num_th :: Int64</code>, the number of threads. Facultative, <code>NumThreads</code> by default. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/opmat.jl#L137-L146">source</a></section></article><p>Note that sometimes it is needed to transform a state from one basis to another. This can be done by constructing an identity operator. </p><pre><code class="language-julia hljs">stf = Operator(bsd, bsf, [Term(1., [-1, -1])]) * std</code></pre><p>The <code>OpMat</code> object can be converted into a full matrix or converted with the <code>SparseMatrixCSC</code> object in the <code>SparseArrays</code> package. This will allow, <em>e.g.</em>, full diagonalisation using the linear algebra package of julia. </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.SparseMatrixCSCFromOpMat-Tuple{OpMat}" href="#Main.FuzzifiED.SparseMatrixCSCFromOpMat-Tuple{OpMat}"><code>Main.FuzzifiED.SparseMatrixCSCFromOpMat</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">SparseMatrixCSCFromOpMat(mat :: OpMat{ComplexF64}) :: SparseMatrixCSC{Int64,ComplexF64}
SparseMatrixCSCFromOpMat(mat :: OpMat{Float64}) :: SparseMatrixCSC{Int64,Float64}</code></pre><p>converts the <code>OpMat</code> objects to a <code>SparseMatrixCSC</code> object in the <code>SparseArrays</code> package.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/opmat.jl#L159-L164">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.MatrixFromOpMat-Tuple{OpMat}" href="#Main.FuzzifiED.MatrixFromOpMat-Tuple{OpMat}"><code>Main.FuzzifiED.MatrixFromOpMat</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">MatrixFromOpMat(mat :: OpMat{ComplexF64}) :: Matrix{ComplexF64}
MatrixFromOpMat(mat :: OpMat{Float64}) :: Matrix{Int64,Float64}</code></pre><p>converts the <code>OpMat</code> objects to a full matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/opmat.jl#L188-L193">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.OpMat-Tuple{SparseMatrixCSC}" href="#Main.FuzzifiED.OpMat-Tuple{SparseMatrixCSC}"><code>Main.FuzzifiED.OpMat</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">OpMat(matcsc :: SparseMatrixCSC{Int64,ComplexF64}) :: OpMat{ComplexF64}
OpMat(matcsc :: SparseMatrixCSC{Int64,Float64}) :: OpMat{Float64}</code></pre><p>converts the <code>SparseMatrixCSC</code> object in the <code>SparseArrays</code> package to an <code>OpMat</code> objects.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/opmat.jl#L177-L182">source</a></section></article><h2 id="Entanglement"><a class="docs-heading-anchor" href="#Entanglement">Entanglement</a><a id="Entanglement-1"></a><a class="docs-heading-anchor-permalink" href="#Entanglement" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.StateDecompMat-Tuple{Vector{&lt;:Number}, Basis, Basis, Basis, Vector{&lt;:Number}, Vector{&lt;:Number}}" href="#Main.FuzzifiED.StateDecompMat-Tuple{Vector{&lt;:Number}, Basis, Basis, Basis, Vector{&lt;:Number}, Vector{&lt;:Number}}"><code>Main.FuzzifiED.StateDecompMat</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function StateDecompMat(st :: Vector{&lt;:Number}, bs0 :: Basis, bsa :: Basis, bsb :: Basis, amp_oa :: Vector{ComplexF64}, amp_ob :: Vector{ComplexF64}) :: Matrix{ComplexF64}</code></pre><p>Decompose a state <span>$|œà‚ü©=v_I|I‚ü©$</span> into a direct-product basis of two subsystems <span>$|œà‚ü©=M_{JI}|I_A‚ü©|J_B‚ü©$</span></p><p><strong>Arguments</strong></p><ul><li><code>st :: Vector{&lt;:Number}</code> is the state to be decomposed into direct-product basis of two subsystems.</li><li><code>bs0 :: Basis</code> is the total basis. </li><li><code>bsa :: Basis</code> is the basis for the subsystem A.</li><li><code>bsb :: Basis</code> is the basis for the subsystem B. </li><li><code>amp_oa :: Vector{ComplexF64}</code> is a complex list of length <code>no</code> that specifies the amplitute of each orbital in the subsystem A. For a non-local basis, we decompose each electron into creation operators in two subsystems <span>$c^‚Ä†_o=a_{o,A}c^‚Ä†_{o,A}+a_{o,B}c^‚Ä†_{o,B}$</span> and this list specifies <span>$a_{o,A}$</span>. This is equivalent to <span>$‚àö{‚Ñ±_{m,A}}$</span> in <a href="https://dx.doi.org/10.1103/PhysRevB.85.125308">PRB 85, 125308 (2012)</a> with an extra phase factor. </li><li><code>amp_ob :: Vector{ComplexF64}</code> is a complex list of length <code>no</code> that specifies the amplitute of each orbital in the subsystem B. </li></ul><p><strong>Output</strong></p><p>A complex matrix of dimension <code>bsb.dim * bsa.dim</code> that corresponds to the state in the decomposed basis <span>$|œà‚ü©=M_{JI}|I_A‚ü©|J_B‚ü©$</span>. This is equivalent to <span>$R_{ŒºŒΩ}^A/‚àöp$</span> in <a href="https://dx.doi.org/10.1103/PhysRevB.85.125308">PRB 85, 125308 (2012)</a>. After calculating all the sectors, the reduced density matrix will be <span>$œÅ_B=‚äï\mathbf{M}\mathbf{M}^‚Ä†$</span></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/entangle.jl#L1-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.FuzzifiED.GetEntSpec-Tuple{Vector{&lt;:Number}, Basis, Vector{Vector{Vector{Int64}}}, Vector{Vector{Vector{Int64}}}}" href="#Main.FuzzifiED.GetEntSpec-Tuple{Vector{&lt;:Number}, Basis, Vector{Vector{Vector{Int64}}}, Vector{Vector{Vector{Int64}}}}"><code>Main.FuzzifiED.GetEntSpec</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function GetEntSpec(st :: Vector{&lt;:Number}, bs0 :: Basis, secd_lst :: Vector{Vector{Vector{Int64}}}, secf_lst :: Vector{Vector{Vector{&lt;:Number}}} ; qnd_a :: Vector{QNDiag}, qnd_b :: Vector{QNDiag} = qnd_a, qnf_a :: Vector{QNOffd}, qnf_b :: Vector{QNOffd} = qnf_a, amp_oa :: Vector{&lt;:Number}, amp_ob :: Vector{&lt;:Number} = sqrt.(1 .- abs.(amp_oa .^ 2))) :: Dict{@NamedTuple{secd_a, secf_a, secd_b, secf_b}, Vector{Float64}}</code></pre><p><strong>Arguments</strong></p><ul><li><code>st :: Vector{&lt;:Number}</code> is the state to be decomposed into direct-product basis of two subsystems.</li><li><code>bs0 :: Basis</code> is the total basis. </li><li><code>secd_lst :: Vector{Vector{Vector{Int64}}}</code> gives the list of QNDiag sectors of subsystems to be calculated. Each of its elements is a two element vector ; the first specifies the sector for subsystem A, and the second specifies the sector for subsystem B. </li><li><code>secf_lst :: Vector{Vector{Vector{ComplexF64}}}</code> gives the list of QNOffd sectors of subsystems to be calculated. Each of its elements is a two element vector ; the first specifies the sector for subsystem A, and the second specifies the sector for subsystem B. </li><li><code>qnd_a :: Vector{QNDiag}, qnd_b :: Vector{QNDiag} = qnd_a, qnf_a :: Vector{QNOffd}, qnf_b :: Vector{QNOffd}</code> specifies the diagonal and off-diagonal quantum numbers of the subsystems A and B. <code>qnd_b</code> and <code>qnf_b</code> are facultative and the same as <code>qnd_a</code> and <code>qnf_a</code> by default. </li><li><code>amp_oa :: Vector{ComplexF64}</code> and <code>amp_ob :: Vector{ComplexF64}</code> are complex lists of length <code>no</code> that specify the amplitute of each orbital in the subsystems A and B. For a non-local basis, we decompose each electron into creation operators in two subsystems <span>$c^‚Ä†_o=a_{o,A}c^‚Ä†_{o,A}+a_{o,B}c^‚Ä†_{o,B}$</span> and this list specifies <span>$a_{o,A}$</span>. This is equivalent to <span>$‚àö{‚Ñ±_{m,A}}$</span> in <a href="https://dx.doi.org/10.1103/PhysRevB.85.125308">PRB 85, 125308 (2012)</a> with an extra phase factor. </li></ul><p><strong>Output</strong></p><p>A dictionary whose keys are named tuples that specify the sector containing entries <code>secd_a</code>, <code>secf_a</code>, <code>secd_b</code>, <code>secf_b</code> and values are lists of eigenvalues of the density matrix in those sectors. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mankai-chow/fuzzifi_ed/blob/e96ea45ed4e3a115652fa87a6c81bfce87c180f1/src/core/entangle.jl#L30-L46">source</a></section></article><h2 id="File-operations"><a class="docs-heading-anchor" href="#File-operations">File operations</a><a id="File-operations-1"></a><a class="docs-heading-anchor-permalink" href="#File-operations" title="Permalink"></a></h2><p>FuzzifiED supports writing the types <code>Confs</code>, <code>Basis</code>, <code>Vector{Term}</code>, <code>Operator</code>, <code>OpMat{ComplexF64}</code> and <code>OpMat{Float64}</code> into and reading them from groups and subgroups in HDF5 format. </p><pre><code class="language-julia hljs">using HDF5 
open(file_name, &quot;cw&quot;)
# include the file name as a string 
# Modes : &quot;cw&quot; for write and &quot;r&quot; for read
...
close(f)</code></pre><p>To write, include in the middle </p><pre><code class="language-julia hljs">write(f, group_name :: String, cfs :: Confs)
write(f, group_name :: String, bs  :: Basis)
write(f, group_name :: String, tms :: Vector{Term})
write(f, group_name :: String, op  :: Operator)
write(f, group_name :: String, mat :: OpMat{ComplexF64})
write(f, group_name :: String, mat :: OpMat{Float64})</code></pre><p>To read, include in the middle </p><pre><code class="language-julia hljs">cfs = read(f, group_name :: String, Confs)
bs  = read(f, group_name :: String, Basis)
tms = read(f, group_name :: String, Vector{Term})
op  = read(f, group_name :: String, Operator)
mat = read(f, group_name :: String, OpMat{ComplexF64})
mat = read(f, group_name :: String, OpMat{Float64})</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../example/">¬´ Example</a><a class="docs-footer-nextpage" href="../itensors/">ITensors support ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Saturday 28 September 2024 16:39">Saturday 28 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
